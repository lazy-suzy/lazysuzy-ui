<img
  *ngIf="isProductFetching; else showDetails"
  [src]="spinner"
  class="loader"
/>

<ng-template #showDetails>
  <div class="images-container" #gallery>
    <div class="images">
      <img
        *ngFor="let image of items; index as i"
        [src]="image.data.src"
        (click)="openLightbox(i)"
        class="prod-img"
      />
    </div>
  </div>
  <div class="product-content">
    <div class="flex justify-between">
      <div class="product-name">{{ product.name }}</div>
      <div *ngIf="product && product.wishlisted; else elseBlock">
        <div class="tile-icon wishlist-icon wishlist-container">
          <mat-icon (click)="wishlistProduct(product.sku, false)"
            >favorite
          </mat-icon>
        </div>
      </div>
      <ng-template #elseBlock>
        <div class="tile-icon wishlist-icon wishlist-container">
          <mat-icon (click)="wishlistProduct(product.sku, true)"
            >favorite_border
          </mat-icon>
        </div>
      </ng-template>
    </div>
    <div class="product-site">{{ product.site }}</div>
    <div class="price-container">
      <span class="product-price mr3">${{ productPrice }}</span>
      <span class="strike {{ productPrice !== productWasPrice ? '' : 'dn' }}"
        >${{ productWasPrice }}</span
      >
      <button mat-raised-button class="view-details-btn">
        <a
          (click)="openLink($event, product.product_url)"
          [href]="product.product_url"
          class="tr-viewDetails no-underline yellow"
        >
          View Details
        </a>
      </button>
    </div>
    <hr class="modal-hr" />
    <div class="variation-container" *ngIf="variationsExist">
      <span class="title">Options</span>
      <span class="clear-btn" (click)="clearVariations()">Clear</span>
      <div class="variation-options">
        <div
          class="variation"
          *ngFor="let variation of swatches; let i = index"
          (click)="selectedVariation(variation, i, gallery)"
          [class.activeVariation]="selectedIndex === i"
        >
          <a>
            <img
              [src]="variation.swatch_image"
              [alt]="variation.name"
              class="variant-image"
            />
          </a>
        </div>
        <div *ngIf="swatches.length === 0">
          No product available, please change/clear options
        </div>
      </div>
    </div>
    <app-variations
      *ngIf="variationsExist"
      [variations]="product.variations"
      [isSwatchExist]="isSwatchExist"
      [inputSelections]="product.selections"
      (setPrice)="onSetPrice($event)"
      (setImage)="onSetImage($event)"
      (setSwatches)="setSwatches($event)"
    ></app-variations>
    <div class="pv2">
      <ul class="description-menu">
        <li
          (click)="selectTab('desc')"
          *ngIf="descriptionExist"
          class="{{ activeTab === 'desc' ? 'active' : 'bg-white' }}"
        >
          <a class="nav-link">Description</a>
        </li>
        <li
          (click)="selectTab('features')"
          *ngIf="featuresExist"
          class="{{ activeTab === 'features' ? 'active' : 'bg-white' }}"
        >
          <a class="nav-link">Features</a>
        </li>
        <li
          (click)="selectTab('dimensions')"
          *ngIf="dimensionExist"
          class="{{ activeTab === 'dimensions' ? 'active' : 'bg-white' }}"
        >
          <a class="nav-link">Dimensions</a>
        </li>
      </ul>
      <div class="menu-content">
        <div
          *ngIf="descriptionExist"
          class="{{ activeTab === 'desc' ? '' : 'dn' }}"
        >
          <div [innerHTML]="description"></div>
        </div>
        <div
          *ngIf="featuresExist"
          class="{{ activeTab === 'features' ? '' : 'dn' }}"
        >
          <div class="mt1 pl3">
            <div [innerHTML]="features"></div>
          </div>
        </div>
        <div
          *ngIf="dimensionExist"
          class="{{ activeTab === 'dimensions' ? '' : 'dn' }}"
        >
          <div
            *ngIf="isArray(product.dimension); else showDimensions"
            class="dimension-container"
          >
            <div
              *ngFor="let dimension of product.dimension"
              class="fl w-50 pa2"
            >
              <div class="dimension-title">{{ dimension.description }}</div>
              <div>Width: {{ dimension.width }}</div>
              <div>Depth: {{ dimension.depth }}</div>
              <div>Height: {{ dimension.height }}</div>
              <br />
            </div>
          </div>
          <ng-template #showDimensions>
            <div>
              {{ product.dimension }}
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<img
  *ngIf="isProductFetching; else showDetails"
  [src]="spinner"
  class="loader"
/>

<ng-template #showDetails>
  <div class="images-container" #gallery>
    <div class="images">
      <img
        *ngFor="let image of items; index as i"
        [src]="image.data.src"
        (click)="openLightbox(i)"
        class="prod-img"
      />
    </div>
  </div>
  <div class="product-content">
    <div class="flex justify-between">
      <div class="product-name">{{ product.name }}</div>
      <div *ngIf="product && product.wishlisted; else elseBlock">
        <div class="tile-icon wishlist-icon wishlist-container">
          <mat-icon (click)="wishlistProduct(product.sku, false)"
            >favorite
          </mat-icon>
        </div>
      </div>
      <ng-template #elseBlock>
        <div class="tile-icon wishlist-icon wishlist-container">
          <mat-icon (click)="wishlistProduct(product.sku, true)"
            >favorite_border
          </mat-icon>
        </div>
      </ng-template>
    </div>
    <div class="product-site">{{ product.site }}</div>
    <div class="price-container flex flex-wrap">
      <div class="product-price mr3">${{ productPrice }}</div>
      <div class="strike {{ productPrice !== productWasPrice ? '' : 'dn' }}">
        ${{ productWasPrice }}
      </div>
      <button
        mat-raised-button
        class="bg-red view-details-btn"
        *ngIf="!product.redirect"
      >
        <a
          (click)="openLink($event, product.product_url)"
          [href]="product.product_url"
          class="tr-viewDetails no-underline yellow"
        >
          View Details
        </a>
      </button>
    </div>
    <hr
      class="modal-hr mt-3"
      *ngIf="isVariationExist || product.set || product.redirect"
    />
    <app-redirect
      *ngIf="product.redirect"
      [redirectUrl]="product.redirect_url"
      [redirectDetails]="product.redirect_details"
      [category]="product.department_info[0].category_name"
      [categoryUrl]="product.department_info[0].category_url"
      [isHandset]="true"
    ></app-redirect>
    <app-variations
      *ngIf="isVariationExist && !product.redirect"
      [variations]="variations"
      [isSwatchExist]="isSwatchExist"
      [inputSelections]="product.selections"
      (setPrice)="onSetPrice($event)"
      (setImage)="onSetImage($event)"
      (reload)="onVariationChange()"
    ></app-variations>
    <app-sets *ngIf="product.set" [sets]="product.set" [brand]="product.site">
    </app-sets>
    <hr class="modal-hr" />
    <div class="pv2">
      <ul class="description-menu">
        <li
          (click)="selectTab('desc')"
          *ngIf="descriptionExist"
          class="{{ activeTab === 'desc' ? 'active' : 'bg-white' }}"
        >
          <span class="nav-link">Description</span>
        </li>
        <li
          (click)="selectTab('features')"
          *ngIf="featuresExist"
          class="{{ activeTab === 'features' ? 'active' : 'bg-white' }}"
        >
          <span class="nav-link">Features</span>
        </li>
        <li
          (click)="selectTab('dimensions')"
          *ngIf="dimensionExist"
          class="{{ activeTab === 'dimensions' ? 'active' : 'bg-white' }}"
        >
          <span class="nav-link">Dimensions</span>
        </li>
      </ul>
      <div class="menu-content">
        <div
          *ngIf="descriptionExist"
          class="{{ activeTab === 'desc' ? '' : 'dn' }}"
        >
          <div [innerHTML]="description"></div>
        </div>
        <div
          *ngIf="featuresExist"
          class="{{ activeTab === 'features' ? '' : 'dn' }}"
        >
          <div class="mt1 pl3">
            <div [innerHTML]="features"></div>
          </div>
        </div>
        <div
          *ngIf="dimensionExist"
          class="{{ activeTab === 'dimensions' ? '' : 'dn' }}"
        >
          <div
            *ngIf="isArray(product.dimension); else showDimensions"
            class="dimension-container"
          >
            <div
              *ngFor="let dimension of product.dimension"
              class="fl w-50 pa2"
            >
              <div class="dimension-title">{{ dimension.description }}</div>
              <div>Width: {{ dimension.width }}</div>
              <div>Depth: {{ dimension.depth }}</div>
              <div>Height: {{ dimension.height }}</div>
              <br />
            </div>
          </div>
          <ng-template #showDimensions>
            <div>
              {{ product.dimension }}
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</ng-template>
